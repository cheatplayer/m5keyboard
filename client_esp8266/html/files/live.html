<!Doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<link rel="stylesheet" href="style.css">
		<script src="functions.js"></script>
		<meta name="viewport" content="width=device-width, initial-scale=0.8">
		<meta charset="utf-8">
		<title>Wi-Fi Ducky</title>
		<meta name="description" content="Wi-Fi enabled USB HID">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="stylesheet" href="normalize.css">
		<link rel="stylesheet" href="skeleton.css">
	</head>
	<body>
		<nav>
			<a href="index.html">Scripts</a>
			<a href="live.html">Live Execute</a>
			<a href="settings.html">Settings</a>
			<ul class="nav right">
				<a href="info.html">Info</a>
			<ul>
		</nav>
		<div id="error"></div>
		<div class="container">
			<div class="row">
				<div class="twelve columns">
					<h1 class="header">Live Execute</h1>
					
					<form>
						<textarea id="scriptTextArea" name='script' maxlength="1024" placeholder="STRING Hello World!" onkeyup="count()" onkeydown="count()" onchange="count()"></textarea>
						<p><span id="charCount">0</span> / 1024</p>
					</form>
					<button onclick="save()" class="left">save script</button>
					<button onclick="run()" class="button-primary right">run script</button>
					
					<br />
					<br />
					<br />
					
				</div>
			</div>
		</div>
		<script>
		
			function count(){
				document.getElementById("charCount").innerHTML = document.getElementById("scriptTextArea").value.length;
			}
			
			function run(){
				var script = document.getElementById("scriptTextArea").value.replace(/\n\r?/g, '%0D');
				getResponse("run?script="+script,function(responseText){
					if(responseText == "true") showMessage("Executing Script...",2500);
				},undefined,undefined, "POST");
			}
			
			function save(){
				var scriptName = prompt("Scriptname:");
				if(scriptName !== null){
					var script = document.getElementById("scriptTextArea").value.replace(/\n\r?/g, '%0D');
					console.log(script);
					getResponse("save?name="+scriptName+"&script="+script,function(responseText){
						if(responseText == "true") showMessage("Script saved as '"+scriptName+"'",2500);
					},undefined,undefined, "POST");
				}
			}
		</script>
	</body>
</html>
